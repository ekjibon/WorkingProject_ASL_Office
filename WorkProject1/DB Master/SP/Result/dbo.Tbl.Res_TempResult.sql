IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[Res_TempResult]'))
BEGIN
DROP TABLE  Res_TempResult
END

CREATE TABLE Res_TempResult(
	[StudentIID] [bigint] NULL,

	[TotalMarks] [decimal](8, 2)  NULL,
	[GPA] [decimal](8, 2)  NULL,
	[GPAWithOut4Sub] [decimal](8, 2)  NULL,
	[GradeLetter] [nvarchar](max) NULL,
	[IsPass] [bit]  NULL,
	[OverAllMerit] [int]  NULL,
	[SectionWiseMerit] [int]  NULL,
	[ShiftWiseMerit] [int]  NULL,
	[ClassWiseMerit] [int]  NULL,
	[TeacherComments] [nvarchar](max) NULL,
	[Conduct] [nvarchar](max) NULL,
	[Handwriting] [nvarchar](max) NULL,
	
	[TotalConvertedMarks] [decimal](8, 2)  NULL,
	[TotalConvertedMarksFraction] [decimal](8, 2)  NULL,
	[FailStudentGPA] [decimal](8, 2)  NULL,
	[TotalGP] [decimal](8, 2)  NULL,
	[TotalGPWithOut4Sub] [decimal](8, 2)  NULL,
	
	[SubjectId] [int] NULL,
	[SubjectName] [varchar](50) NULL,
	[Org_SubjectType] [varchar](5) NULL,
	[Student_SubjectType] [varchar](5) NULL,
	[ReportSerialNo] [INT] NULL,
	[IsNoEffectOnExam] [BIT] NULL,

	[SubjectGP] [decimal](10, 2) NULL,
	[SubjectGL] [varchar](50) NULL,
	[SubjectObtMarks] [decimal](10, 2) NULL,
	[SubjectConvertedMarks] [decimal](10, 2) NULL,
	[SubjectConvertedMarksFraction] [decimal](10, 2) NULL,
	[SubjectHighestMark] [decimal](10, 2) NULL,

	[VirtualConvertedMarks1] [decimal](10, 2)  NULL,
	[VirtualIsPass1] [bit]  NULL,
	[VirtualConvertedMarks2] [decimal](10, 2)  NULL,
	[VirtualIsPass2] [bit]  NULL,

	

	[MainExamName] [varchar](50) NULL,
	[MainExamFullMark] [decimal](10, 2) NULL,
	[MainExamPassMark] [decimal](10, 2) NULL,
	---  Sub Exam 1 
	[SubExam1Name] [varchar](50) NULL,
	[S1IsEnable] [bit] NULL,
	[S1W1Obt] [decimal](10, 2) NULL,
	[S1W2Obt] [decimal](10, 2) NULL,
	[S1W3Obt] [decimal](10, 2) NULL,
	[S1SubObt] [decimal](10, 2) NULL,
	[S1ObjObt] [decimal](10, 2)  NULL ,
	[S1PraObt] [decimal](10, 2) NULL,

	[S1W1Conv] [decimal](10, 2) NULL,
	[S1W2Conv] [decimal](10, 2) NULL,
	[S1W3Conv] [decimal](10, 2) NULL,
	[S1SubConv] [decimal](10, 2) NULL,
	[S1ObjConv] [decimal](10, 2) NULL,
	[S1PraConv] [decimal](10, 2) NULL,

	[S1W1Frac] [decimal](10, 2) NULL,
	[S1W2Frac] [decimal](10, 2) NULL,
	[S1W3Frac] [decimal](10, 2) NULL,
	[S1SubFrac] [decimal](10, 2) NULL,
	[S1ObjFrac] [decimal](10, 2) NULL,
	[S1PraFrac] [decimal](10, 2) NULL,

	[S1W1ExamMark] [decimal](10, 2) NULL,
	[S1W1ExamConvertMark] [decimal](10, 2) NULL,
	[S1W2ExamMark] [decimal](10, 2) NULL,
	[S1W2ExamConvertMark] [decimal](10, 2) NULL,
	[S1W3ExamMark] [decimal](10, 2) NULL,
	[S1W3ExamConvertMark] [decimal](10, 2) NULL,
	[S1SubExamMark] [decimal](10, 2) NULL,
	[S1SubExamConvertMark] [decimal](10, 2) NULL,
	[S1ObjExamMark] [decimal](10, 2) NULL,
	[S1ObjExamConvertMark] [decimal](10, 2) NULL,
	[S1PraExamMark] [decimal](10, 2) NULL,
	[S1PraExamConvertMark] [decimal](10, 2) NULL,
	
	[S1W1PassMark] [decimal](10, 2) NULL,
	[S1W2PassMark] [decimal](10, 2) NULL,
	[S1W3PassMark] [decimal](10, 2) NULL,
	[S1SubPassMark] [decimal](10, 2) NULL,
	[S1ObjPassMark] [decimal](10, 2) NULL,
	[S1PraPassMark] [decimal](10, 2) NULL,


	[S1TotalObt] [decimal](10, 2) NULL,
	[S1TotalConv] [decimal](10, 2) NULL,
	[S1TotalFrac] [decimal](10, 2) NULL,
	[S1IsPass] [bit] NULL,
	[S1IsAbs] [bit] NULL,


	[S1W1IsPass]  [bit] NULL,
	[S1W2IsPass]  [bit] NULL,
	[S1W3IsPass]  [bit] NULL,
	[S1SubIsPass] [bit] NULL,
	[S1ObjIsPass] [bit] NULL,
	[S1PraIsPass] [bit] NULL,

	[S1W1IsAbs]  [bit] NULL,
	[S1W2IsAbs]  [bit] NULL,
	[S1W3IsAbs]  [bit] NULL,
	[S1SubIsAbs] [bit] NULL,
	[S1ObjIsAbs] [bit] NULL,
	[S1PraIsAbs] [bit] NULL,

	
	[S1W1IsEnable]  [bit] NULL,
	[S1W2IsEnable]  [bit] NULL,
	[S1W3IsEnable]  [bit] NULL,
	[S1SubIsEnable] [bit] NULL,
	[S1ObjIsEnable] [bit] NULL,
	[S1PraIsEnable] [bit] NULL,

	[S1PassMark] [decimal](10, 2) NULL,
	[S1ExamMark] [decimal](10, 2) NULL,
	[S1ExamConvtMark] [decimal](10, 2) NULL,

	[S1SOPTotalObt] [decimal](10, 2) NULL,
	[S1SOPTotalConv] [decimal](10, 2) NULL,
	[S1SOPTotalFrac] [decimal](10, 2) NULL,
	---  Sub Exam 2 
	[SubExam2Name] [varchar](50) NULL,
	[S2IsEnable] [bit] NULL,
	[S2W1Obt] [decimal](10, 2) NULL,
	[S2W2Obt] [decimal](10, 2) NULL,
	[S2W3Obt] [decimal](10, 2) NULL,
	[S2SubObt] [decimal](10, 2) NULL,
	[S2ObjObt] [decimal](10, 2) NULL,
	[S2PraObt] [decimal](10, 2) NULL,

	[S2W1Conv] [decimal](10, 2) NULL,
	[S2W2Conv] [decimal](10, 2) NULL,
	[S2W3Conv] [decimal](10, 2) NULL,
	[S2SubConv] [decimal](10, 2) NULL,
	[S2ObjConv] [decimal](10, 2) NULL,
	[S2PraConv] [decimal](10, 2) NULL,

	[S2W1Frac] [decimal](10, 2) NULL,
	[S2W2Frac] [decimal](10, 2) NULL,
	[S2W3Frac] [decimal](10, 2) NULL,
	[S2SubFrac] [decimal](10, 2) NULL,
	[S2ObjFrac] [decimal](10, 2) NULL,
	[S2PraFrac] [decimal](10, 2) NULL,

	[S2W1ExamMark] [decimal](10, 2) NULL,
	[S2W1ExamConvertMark] [decimal](10, 2) NULL,
	[S2W2ExamMark] [decimal](10, 2) NULL,
	[S2W2ExamConvertMark] [decimal](10, 2) NULL,
	[S2W3ExamMark] [decimal](10, 2) NULL,
	[S2W3ExamConvertMark] [decimal](10, 2) NULL,
	[S2SubExamMark] [decimal](10, 2) NULL,
	[S2SubExamConvertMark] [decimal](10, 2) NULL,
	[S2ObjExamMark] [decimal](10, 2) NULL,
	[S2ObjExamConvertMark] [decimal](10, 2) NULL,
	[S2PraExamMark] [decimal](10, 2) NULL,
	[S2PraExamConvertMark] [decimal](10, 2) NULL,
	
	
	[S2W1PassMark] [decimal](10, 2) NULL,
	[S2W2PassMark] [decimal](10, 2) NULL,
	[S2W3PassMark] [decimal](10, 2) NULL,
	[S2SubPassMark] [decimal](10, 2) NULL,
	[S2ObjPassMark] [decimal](10, 2) NULL,
	[S2PraPassMark] [decimal](10, 2) NULL,

	[S2TotalObt] [decimal](10, 2) NULL,
	[S2TotalConv] [decimal](10, 2) NULL,
	[S2TotalFrac] [decimal](10, 2) NULL,
	[S2IsPass] [bit] NULL,
	[S2IsAbs] [bit] NULL,

	[S2W1IsPass]  [bit] NULL,
	[S2W2IsPass]  [bit] NULL,
	[S2W3IsPass]  [bit] NULL,
	[S2SubIsPass] [bit] NULL,
	[S2ObjIsPass] [bit] NULL,
	[S2PraIsPass] [bit] NULL,

	[S2W1IsAbs]  [bit] NULL,
	[S2W2IsAbs]  [bit] NULL,
	[S2W3IsAbs]  [bit] NULL,
	[S2SubIsAbs] [bit] NULL,
	[S2ObjIsAbs] [bit] NULL,
	[S2PraIsAbs] [bit] NULL,

	

	[S2W1IsEnable]  [bit] NULL,
	[S2W2IsEnable]  [bit] NULL,
	[S2W3IsEnable]  [bit] NULL,
	[S2SubIsEnable] [bit] NULL,
	[S2ObjIsEnable] [bit] NULL,
	[S2PraIsEnable] [bit] NULL,

	[S2PassMark] [decimal](10, 2) NULL,
	[S2ExamMark] [decimal](10, 2) NULL,
	[S2ExamConvtMark] [decimal](10, 2) NULL,

	[S2SOPTotalObt] [decimal](10, 2) NULL,
	[S2SOPTotalConv] [decimal](10, 2) NULL,
	[S2SOPTotalFrac] [decimal](10, 2) NULL,
	--Sub Exam 3
	
	[SubExam3Name] [varchar](50) NULL,
	[S3IsEnable] [bit] NULL,
	[S3W1Obt] [decimal](10, 2) NULL,
	[S3W2Obt] [decimal](10, 2) NULL,
	[S3W3Obt] [decimal](10, 2) NULL,
	[S3SubObt] [decimal](10, 2) NULL,
	[S3ObjObt] [decimal](10, 2) NULL,
	[S3PraObt] [decimal](10, 2) NULL,

	[S3W1Conv] [decimal](10, 2) NULL,
	[S3W2Conv] [decimal](10, 2) NULL,
	[S3W3Conv] [decimal](10, 2) NULL,
	[S3SubConv] [decimal](10, 2) NULL,
	[S3ObjConv] [decimal](10, 2) NULL,
	[S3PraConv] [decimal](10, 2) NULL,

	[S3W1Frac] [decimal](10, 2) NULL,
	[S3W2Frac] [decimal](10, 2) NULL,
	[S3W3Frac] [decimal](10, 2) NULL,
	[S3SubFrac] [decimal](10, 2) NULL,
	[S3ObjFrac] [decimal](10, 2) NULL,
	[S3PraFrac] [decimal](10, 2) NULL,

	[S3W1ExamMark] [decimal](10, 2) NULL,
	[S3W1ExamConvertMark] [decimal](10, 2) NULL,
	[S3W2ExamMark] [decimal](10, 2) NULL,
	[S3W2ExamConvertMark] [decimal](10, 2) NULL,
	[S3W3ExamMark] [decimal](10, 2) NULL,
	[S3W3ExamConvertMark] [decimal](10, 2) NULL,
	[S3SubExamMark] [decimal](10, 2) NULL,
	[S3SubExamConvertMark] [decimal](10, 2) NULL,
	[S3ObjExamMark] [decimal](10, 2) NULL,
	[S3ObjExamConvertMark] [decimal](10, 2) NULL,
	[S3PraExamMark] [decimal](10, 2) NULL,
	[S3PraExamConvertMark] [decimal](10, 2) NULL,

	[S3W1PassMark] [decimal](10, 2) NULL,
	[S3W2PassMark] [decimal](10, 2) NULL,
	[S3W3PassMark] [decimal](10, 2) NULL,
	[S3SubPassMark] [decimal](10, 2) NULL,
	[S3ObjPassMark] [decimal](10, 2) NULL,
	[S3PraPassMark] [decimal](10, 2) NULL,


	[S3TotalObt] [decimal](10, 2) NULL,
	[S3TotalConv] [decimal](10, 2) NULL,
	[S3TotalFrac] [decimal](10, 2) NULL,
	[S3IsPass] [bit] NULL,
	[S3IsAbs] [bit] NULL,

	[S3W1IsPass]  [bit] NULL,
	[S3W2IsPass]  [bit] NULL,
	[S3W3IsPass]  [bit] NULL,
	[S3SubIsPass] [bit] NULL,
	[S3ObjIsPass] [bit] NULL,
	[S3PraIsPass] [bit] NULL,

	[S3W1IsAbs]  [bit] NULL,
	[S3W2IsAbs]  [bit] NULL,
	[S3W3IsAbs]  [bit] NULL,
	[S3SubIsAbs] [bit] NULL,
	[S3ObjIsAbs] [bit] NULL,
	[S3PraIsAbs] [bit] NULL,

	[S3W1IsEnable]  [bit] NULL,
	[S3W2IsEnable]  [bit] NULL,
	[S3W3IsEnable]  [bit] NULL,
	[S3SubIsEnable] [bit] NULL,
	[S3ObjIsEnable] [bit] NULL,
	[S3PraIsEnable] [bit] NULL,
	
	[S3PassMark] [decimal](10, 2) NULL,
	[S3ExamMark] [decimal](10, 2) NULL,
	[S3ExamConvtMark] [decimal](10, 2) NULL,

	[S3SOPTotalObt] [decimal](10, 2) NULL,
	[S3SOPTotalConv] [decimal](10, 2) NULL,
	[S3SOPTotalFrac] [decimal](10, 2) NULL,

	--Sub Exam 4
	
	[SubExam4Name] [varchar](50) NULL,
	[S4IsEnable] [bit] NULL,
	[S4W1Obt] [decimal](10, 2) NULL,
	[S4W2Obt] [decimal](10, 2) NULL,
	[S4W3Obt] [decimal](10, 2) NULL,
	[S4SubObt] [decimal](10, 2) NULL,
	[S4ObjObt] [decimal](10, 2) NULL,
	[S4PraObt] [decimal](10, 2) NULL,

	[S4W1Conv] [decimal](10, 2) NULL,
	[S4W2Conv] [decimal](10, 2) NULL,
	[S4W3Conv] [decimal](10, 2) NULL,
	[S4SubConv] [decimal](10, 2) NULL,
	[S4ObjConv] [decimal](10, 2) NULL,
	[S4PraConv] [decimal](10, 2) NULL,

	[S4W1Frac] [decimal](10, 2) NULL,
	[S4W2Frac] [decimal](10, 2) NULL,
	[S4W3Frac] [decimal](10, 2) NULL,
	[S4SubFrac] [decimal](10, 2) NULL,
	[S4ObjFrac] [decimal](10, 2) NULL,
	[S4PraFrac] [decimal](10, 2) NULL,

	[S4W1ExamMark] [decimal](10, 2) NULL,
	[S4W1ExamConvertMark] [decimal](10, 2) NULL,
	[S4W2ExamMark] [decimal](10, 2) NULL,
	[S4W2ExamConvertMark] [decimal](10, 2) NULL,
	[S4W3ExamMark] [decimal](10, 2) NULL,
	[S4W3ExamConvertMark] [decimal](10, 2) NULL,
	[S4SubExamMark] [decimal](10, 2) NULL,
	[S4SubExamConvertMark] [decimal](10, 2) NULL,
	[S4ObjExamMark] [decimal](10, 2) NULL,
	[S4ObjExamConvertMark] [decimal](10, 2) NULL,
	[S4PraExamMark] [decimal](10, 2) NULL,
	[S4PraExamConvertMark] [decimal](10, 2) NULL,

	[S4W1PassMark] [decimal](10, 2) NULL,
	[S4W2PassMark] [decimal](10, 2) NULL,
	[S4W3PassMark] [decimal](10, 2) NULL,
	[S4SubPassMark] [decimal](10, 2) NULL,
	[S4ObjPassMark] [decimal](10, 2) NULL,
	[S4PraPassMark] [decimal](10, 2) NULL,


	[S4TotalObt] [decimal](10, 2) NULL,
	[S4TotalConv] [decimal](10, 2) NULL,
	[S4TotalFrac] [decimal](10, 2) NULL,
	[S4IsPass] [bit] NULL,
	[S4IsAbs] [bit] NULL,

	[S4W1IsPass]  [bit] NULL,
	[S4W2IsPass]  [bit] NULL,
	[S4W3IsPass]  [bit] NULL,
	[S4SubIsPass] [bit] NULL,
	[S4ObjIsPass] [bit] NULL,
	[S4PraIsPass] [bit] NULL,

	[S4W1IsAbs]  [bit] NULL,
	[S4W2IsAbs]  [bit] NULL,
	[S4W3IsAbs]  [bit] NULL,
	[S4SubIsAbs] [bit] NULL,
	[S4ObjIsAbs] [bit] NULL,
	[S4PraIsAbs] [bit] NULL,
	  
	[S4W1IsEnable]  [bit] NULL,
	[S4W2IsEnable]  [bit] NULL,
	[S4W3IsEnable]  [bit] NULL,
	[S4SubIsEnable] [bit] NULL,
	[S4ObjIsEnable] [bit] NULL,
	[S4PraIsEnable] [bit] NULL,
	  
	[S4PassMark] [decimal](10, 2) NULL,
	[S4ExamMark] [decimal](10, 2) NULL,
	[S4ExamConvtMark] [decimal](10, 2) NULL,
	  
	[S4SOPTotalObt] [decimal](10, 2) NULL,
	[S4SOPTotalConv] [decimal](10, 2) NULL,
	[S4SOPTotalFrac] [decimal](10, 2) NULL
) 