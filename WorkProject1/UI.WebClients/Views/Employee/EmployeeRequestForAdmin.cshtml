
@{
    ViewBag.Title = "EmployeeRequestForAdmin";
}

<style>
    #custom-button {
        padding: 5px;
        color: #009db8;
        background-color: rgb(228, 244, 247);
        /*opacity:0.6;*/
        border: 1px solid #009db8;
        border-radius: 5px;
        cursor: pointer;
        font-size: 18px;
    }


    #custom_text {
        margin-left: 10px;
        font-family: sans-serif;
        color: #aaa;
    }

    .btnColor {
        background-color: #009db8;
        color: white;
        font-family: inherit;
    }

    .button-wrapper {
        position: relative;
        width: 150px;
        text-align: center;
        /*margin: 20% auto;*/
    }

    .pending {
        background: rgba(252, 122, 82, 0.5);
        color: #FC7B52;
        padding: 8px 16px;
        border-radius: 27px;
    }

    .button-wrapper span.label {
        position: relative;
        z-index: 0;
        display: inline-block;
        width: 100%;
        background: #c4e9f5;
        cursor: pointer;
        color: #5ebcda;
        padding: 10px 0;
        text-transform: uppercase;
        font-size: 12px;
    }

    #upload {
        display: inline-block;
        position: absolute;
        z-index: 1;
        width: 100%;
        height: 50px;
        top: 0;
        left: 0;
        opacity: 0;
        cursor: pointer;
    }

    .Approved {
        background: rgba(0, 156, 184, 0.521);
        color: #009DB8;
        padding: 8px 16px;
        border-radius: 27px;
    }
</style>
<style>
    .Approved {
        background: rgba(0, 156, 184, 0.521);
        color: #009DB8;
        padding: 8px 16px;
        border-radius: 27px;
    }

    .pending {
        background: rgba(252, 122, 82, 0.5);
        color: #FC7B52;
        padding: 8px 16px;
        border-radius: 27px;
    }

    .Rejected {
        background: #dc3545;
        color: white;
        padding: 8px 16px;
        border-radius: 27px;
    }

    .edit {
        font-size: 25px;
        color: #6b6565;
        cursor: pointer;
    }

    .view {
        font-size: 25px;
        color: #58cf91;
        cursor: pointer;
    }
</style>

<div class="kt-container  kt-container--fluid  kt-grid__item kt-grid__item--fluid" ng-controller="EmpRequestApply">
    <div class="row">
        <div class="kt-portlet kt-portlet--mobile">
            <div class="kt-portlet__head kt-portlet__head--lg">
                <div class="kt-portlet__head-label">
                    <h3 class="kt-portlet__head-title">
                        <!----Titel Text-->
                        Request
                        <!----Titel Text -->
                    </h3>
                </div>
                <div class="kt-portlet__head-toolbar">
                    <div class="kt-portlet__head-wrapper">
                        <div class="dropdown dropdown-inline">
                            <button ng-click="reset();submitted=false" class="btn btn-primary" data-target="#exampleModal" data-toggle="modal"> <i class="fa fa-plus"></i> Add New Request</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="kt-portlet__body">


                <div class="row">
                    <div class="col-md-4 col-sm-5 col-xs-6">
                        <div class="form-group">
                            <div class="col-lg-3 col-md-5 col-sm-4 col-xs-8" style="padding-left:0px">

                                <select class="form-control kt-font-brand" ng-model="pageSize" ng-options="P.value as P.text for P in pageSizeArray"></select>
                            </div>

                        </div>

                    </div>
                    <div class="col-md-4 col-sm-3 col-xs-1">
                    </div>
                    <div class="col-md-4 col-sm-4 col-xs-5">
                        <div id="sample_3_filter" class="pull-right">
                            <input ng-model="q" id="search" class="form-control" placeholder="Filter text">
                        </div>
                    </div>
                </div>
                <table class="table table-bordered table-hover rounded">
                    <thead>
                        <tr>
                            <th>Meeting Person</th>
                            <th class="text-center">Reason</th>
                            <th class="text-center">Date of Submission</th>
                            <th class="text-center">Status</th>
                            <th class="text-center">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-show="RequestList.length <= 0"><td colspan="5" style="text-align:center;"><i class="fa fa-refresh"></i> Loading new data!!</td></tr>
                        <tr dir-paginate="item in RequestList| filter:q  | itemsPerPage: pageSize " current-page="currentPage" ng-style="{'background-color':$even?evenColor:oddColor}">
                            <td ng-hide="item.MeetingPearson==null">{{item.MeetingPearson}}</td>
                            <td ng-show="item.MeetingPearson==null">N/A</td>
                            <td class="text-center" ng-hide="item.Reason==null">{{item.Reason}}</td>
                            <td class="text-center" ng-show="item.Reason==null">N/A</td>
                            <td class="text-center">{{item.AddDate | date:"dd/MM/yyyy"}}</td>
                            <td ng-if="item.Status=='Pending'" class="text-center"><span class="pending ">{{item.Status}}</span></td>
                            <td ng-if="item.Status=='Approved'" class="text-center"><span class="Approved ">{{item.Status}}</span></td>
                            <td ng-if="item.Status=='Rejected'" class="text-center"><span class="Rejected ">{{item.Status}}</span></td>
                            <td class="text-center">
                                <a ng-click="view(item)" data-toggle="modal" data-target="#viewModal" data-whatever="fat">
                                    <i class="fas fa-eye view"></i>
                                </a>
                                <a ng-click="edit(item)" data-toggle="modal" data-target="#exampleModal" data-whatever="fat" ng-show="item.Status=='Pending'">
                                    <i class="far fa-edit edit"></i>
                                </a>

                                <a ng-click="DeleteRequest(item.Id)" href="javascript:;" ng-show="item.Status=='Pending'||item.Status=='Rejected'">
                                    <i class="far fa-trash-alt delete"></i>
                                </a>
                                <a href="javascript:;" ng-show="item.Status=='Approved'">
                                    <i class="far fa-trash-alt" style="font-size: 25px;color: gray;"></i>
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="row">
                    <dir-pagination-controls boundary-links="true" template-url="~/assets/angular/lib/dirPagination.tpl.html"></dir-pagination-controls>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header ">
                    <h5 class="modal-title" id="exampleModalLabel">{{modalTitle}} Request</h5>
                </div>
                <div class="modal-body" style="margin-left: 5%;">
                    <form name="formCommonFeilds" novalidate>
                        <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.RequestType.$invalid}">
                            <label for="text" class="col-sm-3 col-form-label">Request</label>
                            <div class="col-sm-9" style="margin-left: -8%;">
                                <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                    <select class="form-control" ng-model="Request.RequestType" ng-change="LoadCategory()" required name="RequestType" ng-options="m.Id as m.RequestName for m in RequestListType">
                                        <option value="">Select</option>
                                    </select>
                                    <span ng-show="submitted && formCommonFeilds.RequestType.$error.required" class="required">Request Type Required</span>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==1">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.Category.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Category</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <div ng-repeat="item in Dropdowns | filter:Type='EmpPDept'">
                                        <input type="radio" name="Category" ng-model="Request.CategoryId" value="{{item.Value}}" placeholder="{{item.CategoryName}}" />
                                        <span>{{item.Text}}</span>
                                    </div>
                                    <span ng-show="submitted && formCommonFeilds.Category.$error.required" class="required">Category Required</span>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==1 || Request.RequestType==4 || Request.RequestType==6">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.Reason.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Reason</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <textarea class="form-control" rows="4" cols="50" maxlength="460" required name="Reason" ng-model="Request.Reason" id="message-text"></textarea>
                                    <span class="form-help">{{460-Request.Reason.length}} Characters of 460</span>
                                    <span ng-show="submitted && formCommonFeilds.Reason.$error.required" class="required">Reason Required</span>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==2">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.date.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Date</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <input class="form-control" name="date" type="datetime" required placeholder="Date" readonly ng-click="p1=true" is-open="p1" uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.date" />
                                    <span ng-show="submitted && formCommonFeilds.date.$error.required" class="required">Date Required</span>
                                </div>
                            </div>
                            <div>
                                <ul>
                                    <li>Tailor Timing 8.30am to 3.00pm</li>
                                    <li>Tuck Shop 7.40am to 3.00pm</li>
                                </ul>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==1">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.date.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Date</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <input class="form-control" name="date" type="datetime" required placeholder="Date" readonly ng-click="p1=true" is-open="p1" uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.date" />
                                    <span ng-show="submitted && formCommonFeilds.date.$error.required" class="required">Date Required</span>
                                </div>
                            </div>
                            @*<div class="form-group">
                                    <label>Time</label>
                                    <div class="input-group time" id="timepicker" ng-model="Request.Time">
                                        <input class="form-control"  /><span class="input-group-append input-group-addon"><span class="input-group-text"><i class="fa fa-clock"></i></span></span>
                                    </div>
                                </div>*@
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.Time.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Time</label>
                                <div class="col-sm-4" style="margin-left: -8%;">
                                    <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                        <div uib-timepicker ng-model="Request.Time" ng-required="Request.Time==null || Request.Time=='00' || Request.CategoryId==5" name="Time"
                                                onkeypress='return event.charCode >= 48 && event.charCode <= 57' ng-change="changed()" readonly-time="false"
                                                readonly-date="false" disabled-date="false" hour-step="hstep" minute-step="mstep" show-meridian="true"></div>
                                        <span ng-show="submitted &&  formCommonFeilds.Time.$error.required" class="required">Invalid Time </span>
                                    </div>
                                </div>
                                <div class="col-sm-5" ng-repeat="item in EmpMeetingList" ng-show="item.EmpCategoryId==Request.CategoryId && Request.CategoryId==5" style="margin-top: 6%;color: red;text-align: center;font-weight: bold;">
                                    ({{item.StartTime |date:'hh: mm a'}} To  {{item.EndTime |date:'hh: mm a'}})
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==3">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.NOCType.$invalid}">
                                <label for="text" class="col-sm-3 col-form-label">NOC</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                        <select class="form-control" ng-model="Request.NOCType" required name="NOCType" ng-options="m.Id as m.NOCName for m in NOCType">
                                            <option value="">Select</option>
                                        </select>
                                        <span ng-show="submitted && formCommonFeilds.NOCType.$error.required" class="required">NOC Type Required</span>
                                    </div>
                                </div>
                            </div>
                            <div ng-show="Request.NOCType==1">
                                <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.TravelFrom.$invalid}">
                                    <label for="inputPassword" class="col-sm-4 col-form-label">Travel Desination</label>
                                    <div class="col-sm-8" style="margin-left: -8%;">
                                        <input class="form-control" name="TravelDesination" type="text" required placeholder="Travel Desination" ng-model="Request.TravelDesination" />
                                        <span ng-show="submitted && formCommonFeilds.TravelDesination.$error.required" class="required">Travel Desination Required</span>
                                    </div>
                                </div>
                                <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.TravelFrom.$invalid}">
                                    <label for="inputPassword" class="col-sm-4 col-form-label">Travel From</label>
                                    <div class="col-sm-8" style="margin-left: -8%;">
                                        <input class="form-control" name="TravelFrom" type="datetime" required placeholder="Travel From Date" readonly ng-click="p1=true" is-open="p1" uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.TravelFrom" />
                                        <span ng-show="submitted && formCommonFeilds.TravelFrom.$error.required" class="required">From Date Required</span>
                                    </div>
                                </div>
                                <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.TravelTo.$invalid}">
                                    <label for="inputPassword" class="col-sm-4 col-form-label">Travel To</label>
                                    <div class="col-sm-8" style="margin-left: -8%;">
                                        <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                            <input class="form-control" name="TravelTo" type="datetime" required placeholder="Travel To Date" readonly ng-click="p2=true" is-open="p2" uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.TravelTo" />
                                            <span ng-show="submitted && formCommonFeilds.TravelTo.$error.required" class="required">Travel To Date Required</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==5">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.LeaveCategory.$invalid}">
                                <label for="text" class="col-sm-4 col-form-label">Leave Category</label>
                                <div class="col-sm-8" style="margin-left: -8%;">
                                    <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                        <select class="form-control" ng-model="Request.LeaveCategoryId" name="LeaveCategory" ng-options="m.Id as m.CategoryName for m in LeaveCategory" required>
                                            <option value="" selected="selected">Select</option>
                                        </select>
                                        <span ng-show="submitted && formCommonFeilds.LeaveCategory.$error.required" class="required">Type Required</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.FromDate.$invalid}">
                                <label for="inputPassword" class="col-sm-4 col-form-label">From</label>
                                <div class="col-sm-8" style="margin-left: -8%;">
                                    <input class="form-control" required name="FromDate" type="datetime" placeholder="From Date" readonly ng-click="p1=true" is-open="p1" uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.From" />

                                    @*<input class="form-control" required name="FromDate" type="date" placeholder="From Date" ng-model="Leave.From" />*@
                                    <span ng-show="submitted && formCommonFeilds.FromDate.$error.required" class="required">From Date Required</span>
                                </div>
                            </div>
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.To.$invalid}">
                                <label for="inputPassword" class="col-sm-4 col-form-label">To</label>
                                <div class="col-sm-8" style="margin-left: -8%;">
                                    <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                        <input class="form-control" required ng-change="CalculateDuratoin()" name="To" type="datetime" placeholder="To Date" readonly ng-click="p2=true" is-open="p2" uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.To" />

                                        @*<input class="form-control" type="date" required name="To" placeholder="Requested On" ng-change="CalculateDuratoin()" ng-model="Leave.To" />*@
                                        <span ng-show="submitted && formCommonFeilds.To.$error.required" class="required">To Date Required</span>
                                    </div>
                                </div>
                            </div>
                            @*<div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.Request.$invalid}">
                                <label for="text" class="col-sm-3 col-form-label">Request</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                        <input class="form-control" date-disabled="disabled(date, mode)" required name="Request" type="datetime" placeholder="Requested On" readonly ng-click="p3=true" is-open="p3" uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.Request" />

                                        @*<input class="form-control" type="date"  required name="Request"  placeholder="Requested On"    ng-model="Leave.Request" />*@
                            @*<span ng-show="submitted && formCommonFeilds.Request.$error.required" class="required">Request Date Required</span>
                                        </div>
                                    </div>
                                </div>*@

                            <div class="form-group row">
                                <div class="col-sm-4">
                                    <label for="message-text" class="col-form-label">Attachment</label>
                                </div>
                                <div class="col-sm-8" style="margin-left: -7%;">
                                    <input type="file" id="real_file" ng-hide="imgfile" accept="image/x-png,image/gif,image/jpeg" />
                                    <button type="button" id="custom-button"><i class="fas fa-file-medical"> Choose File</i></button>
                                    <span class="demoInputBox" id="custom_text">No file chosen, yet.</span>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==7">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.date.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">From</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <input class="form-control" required name="date" type="datetime" placeholder="Date" ng-click="p2=true" is-open="p2" readonly uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.date" />

                                    <span style="color:red"> Please, Choose a days ahead!!!!</span>
                                    <span ng-show="submitted && formCommonFeilds.date.$error.required" class="required">Date Required</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row" ng-show="Request.NOCType==1 || Request.NOCType==2 || Request.RequestType==4 || Request.RequestType==5|| Request.RequestType==6 || Request.RequestType==7" ng-class="{ 'has-error' : submitted && formCommonFeilds.Description.$invalid}">
                            <div class="col-sm-3">
                                <label for="message-text" class="col-form-label">Description</label>
                            </div>
                            <div class="col-sm-9" style="margin-left: -8%;">
                                <textarea class="form-control" rows="4" cols="50" required name="Description" ng-model="Request.Description" id="message-text" maxlength="460"></textarea>
                                <span class="form-help">{{460-Request.Description.length}} Characters of 460</span>
                                <span ng-show="submitted && formCommonFeilds.Description.$error.required" class="required">Description Required</span>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" ng-click="reset();submitted=false" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-success" ng-click="SaveRequest(Request);submitted=true">{{btnTitle}}</button>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="viewModal" tabindex="-1" role="dialog" aria-labelledby="viewModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">View Request</h5>
                </div>
                <div class="modal-body" style="margin-left: 5%;">
                    <form name="formCommonFeilds" novalidate>
                        <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.RequestType.$invalid}">
                            <label for="text" class="col-sm-3 col-form-label">Request</label>
                            <div class="col-sm-9" style="margin-left: -8%;">
                                <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                    <select class="form-control" disabled ng-model="Request.RequestType" ng-change="LoadCategory()" required name="RequestType" ng-options="m.Id as m.RequestName for m in RequestListType">
                                        <option value="">Select</option>
                                    </select>
                                    <span ng-show="submitted && formCommonFeilds.RequestType.$error.required" class="required">Request Type Required</span>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==1">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.CategoryId.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Category</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <div>
                                        <label class="control-label">{{Request.MeetingPearson}}</label>
                                    </div>
                                    <span ng-show="submitted && formCommonFeilds.CategoryId.$error.required" class="required">Category Required</span>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==1 || Request.RequestType==4">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.Reason.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Reason</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <textarea class="form-control" rows="4" disabled cols="50" readonly maxlength="460" required name="Reason" ng-model="Request.Reason" id="message-text"></textarea>

                                    <span ng-show="submitted && formCommonFeilds.Reason.$error.required" class="required">Reason Required</span>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==2">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.date.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Date</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <input class="form-control" name="date" type="datetime" required placeholder="Date" disabled readonly uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.date" />
                                    <span ng-show="submitted && formCommonFeilds.date.$error.required" class="required">Date Required</span>
                                </div>
                            </div>
                            <div>
                                <ul>
                                    <li>Tailor Timing 8.30am to 3.00pm</li>
                                    <li>Tuck Shop 7.40am to 3.00pm</li>
                                </ul>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==7">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.date.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Date</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <input class="form-control" name="date" type="datetime" required placeholder="Date" disabled readonly uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.date" />
                                    <span ng-show="submitted && formCommonFeilds.date.$error.required" class="required">Date Required</span>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==1">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.date.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Date</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <input class="form-control" name="date" type="datetime" required placeholder="Date" readonly disabled uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.date" />
                                    <span ng-show="submitted && formCommonFeilds.date.$error.required" class="required">Date Required</span>
                                </div>
                            </div>
                            @*<div class="form-group">
                                    <label>Time</label>
                                    <div class="input-group time" id="timepicker" ng-model="Request.Time">
                                        <input class="form-control"  /><span class="input-group-append input-group-addon"><span class="input-group-text"><i class="fa fa-clock"></i></span></span>
                                    </div>
                                </div>*@
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.Time.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">Time</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                        <div uib-timepicker ng-model="Request.Time" ng-required="Request.Time==null" name="Time"
                                                onkeypress='return event.charCode >= 48 && event.charCode <= 57' ng-change="changed()" readonly-time="false"
                                                readonly-date="false" disabled-date="true" hour-step="hstep" minute-step="mstep" show-meridian="true"></div>

                                        <div class="form-control-focus"> </div>
                                        <span ng-show="submitted &&  formCommonFeilds.Time.$error.required" class="required">Invalid Time </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==3">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.NOCType.$invalid}">
                                <label for="text" class="col-sm-3 col-form-label">NOC</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                        <select class="form-control" ng-model="Request.NOCType" disabled required name="NOCType" ng-options="m.Id as m.NOCName for m in NOCType">
                                            <option value="">Select</option>
                                        </select>
                                        <span ng-show="submitted && formCommonFeilds.NOCType.$error.required" class="required">NOC Type Required</span>
                                    </div>
                                </div>
                            </div>
                            <div ng-show="Request.NOCType==1">
                                <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.TravelFrom.$invalid}">
                                    <label for="inputPassword" class="col-sm-3 col-form-label">Travel Desination</label>
                                    <div class="col-sm-9" style="margin-left: -8%;">
                                        <input class="form-control" name="TravelDesination" type="text" disabled required placeholder="Travel Desination" ng-model="Request.TravelDesination" />
                                        <span ng-show="submitted && formCommonFeilds.TravelDesination.$error.required" class="required">Travel Desination Required</span>
                                    </div>
                                </div>
                                <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.TravelFrom.$invalid}">
                                    <label for="inputPassword" class="col-sm-3 col-form-label">Travel From</label>
                                    <div class="col-sm-9" style="margin-left: -8%;">
                                        <input class="form-control" name="TravelFrom" type="datetime" required placeholder="Travel From Date" readonly disabled uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.TravelFrom" />
                                        <span ng-show="submitted && formCommonFeilds.TravelFrom.$error.required" class="required">From Date Required</span>
                                    </div>
                                </div>
                                <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.TravelTo.$invalid}">
                                    <label for="inputPassword" class="col-sm-3 col-form-label">Travel To</label>
                                    <div class="col-sm-9" style="margin-left: -8%;">
                                        <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                            <input class="form-control" name="TravelTo" type="datetime" required placeholder="Travel To Date" readonly disabled uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.TravelTo" />
                                            <span ng-show="submitted && formCommonFeilds.TravelTo.$error.required" class="required">Travel To Date Required</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div ng-show="Request.RequestType==5">
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.LeaveCategoryId.$invalid}">
                                <label for="text" class="col-sm-3 col-form-label">Leave Type</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                        <select class="form-control" ng-model="Request.LeaveCategoryId" disabled name="LeaveCategoryId" ng-options="m.Id as m.CategoryName for m in LeaveCategory" required>
                                            <option value="" selected="selected">Select</option>
                                        </select>
                                        <span ng-show="submitted && formCommonFeilds.LeaveCategoryId.$error.required" class="required">Type Required</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.FromDate.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">From</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <input class="form-control" required name="FromDate" type="datetime" placeholder="From Date" readonly disabled uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.From" />

                                    <span ng-show="submitted && formCommonFeilds.FromDate.$error.required" class="required">From Date Required</span>
                                </div>
                            </div>
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.To.$invalid}">
                                <label for="inputPassword" class="col-sm-3 col-form-label">To</label>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <div class="col-lg-12 col-md-5 col-sm-4 col-xs-8 Item" style="padding-left:0px;padding-right: 1px;">
                                        <input class="form-control" required ng-change="CalculateDuratoin()" name="To" type="datetime" placeholder="To Date" readonly disabled uib-datepicker-popup="dd-MM-yyyy" ng-model="Request.To" />


                                        <span ng-show="submitted && formCommonFeilds.To.$error.required" class="required">To Date Required</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row" ng-class="{ 'has-error' : submitted && formCommonFeilds.Description.$invalid}">
                                <div class="col-sm-3">
                                    <label for="message-text" class="col-form-label">Description</label>
                                </div>
                                <div class="col-sm-9" style="margin-left: -8%;">
                                    <textarea class="form-control" readonly disabled rows="4" cols="50" required name="Description" ng-model="Request.Description" id="message-text" maxlength="460"></textarea>
                                    <span ng-show="submitted && formCommonFeilds.Description.$error.required" class="required">Description Required</span>
                                </div>
                            </div>
                        </div>

                        <div class="form-group row" ng-show="Request.NOCType==1 || Request.NOCType==2 || Request.RequestType==4 || Request.RequestType==7" ng-class="{ 'has-error' : submitted && formCommonFeilds.Description.$invalid}">
                            <div class="col-sm-3">
                                <label for="message-text" class="col-form-label">Description</label>
                            </div>
                            <div class="col-sm-9" style="margin-left: -8%;">
                                <textarea class="form-control" readonly disabled rows="4" cols="50" required name="Description" ng-model="Request.Description" id="message-text" maxlength="460"></textarea>
                                <span ng-show="submitted && formCommonFeilds.Description.$error.required" class="required">Description Required</span>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>

                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts{
    <script type="text/javascript">
        const realFileBtn = document.getElementById("real_file");
        const customBtn = document.getElementById("custom-button");
        const customTxt = document.getElementById("custom_text");

        customBtn.addEventListener("click", function () {
            realFileBtn.click();
        });

        realFileBtn.addEventListener("change", function () {
            $("#custom_text").html("No file chosen, yet.");
            $(".demoInputBox").css("color", "#aaa");
            if (realFileBtn.value) {
                customTxt.innerHTML = realFileBtn.value.match(
                  /[\/\\]([\w\d\s\.\-\(\)]+)$/
                )[1];
            } else {
                customTxt.innerHTML = "No file chosen, yet.";
            }
        });

    </script>
    <script type="text/javascript">
        OEMSApp.controller("EmpRequestApply", ["$scope", "$http", "SweetAlert", "blockUI", "$window", "$filter",
                     function ($scope, $http, SweetAlert, blockUI, $window, $filter) {
                         init();
                         function init() {
                             initialize();
                         }
                         function initialize() {
                             $scope.pageSizeArray = [];
                             $scope.pageSizeArray.push({ value: 5, text: 5 });
                             $scope.pageSizeArray.push({ value: 10, text: 10 });
                             $scope.pageSizeArray.push({ value: 20, text: 20 });
                             $scope.pageSizeArray.push({ value: 50, text: 50 });
                             $scope.currentPage = 1;
                             $scope.pageSize = 10;
                             $scope.Request = {};
                             $scope.Request.Id = 0;
                             $scope.Leave = {};
                             $scope.RequestList = [];
                             $scope.CategoryList = [];
                             $scope.DesignationList = [];
                             $scope.LeaveCategory = [];
                             $scope.hstep = 1;
                             $scope.mstep = 15;
                             $scope.Request.Time = "00";
                             $scope.Request.CategoryId = null;
                             $scope.oddColor = '#E4F4F7';
                             var RequesType = [
                                               { Id: 1, RequestName: "For Meeting" },
                                               //{ Id: 2, RequestName: "For Tailor/TuckShop" },
                                                { Id: 3, RequestName: "For NOC" },
                                                   { Id: 4, RequestName: "For Experience Letter" },
                                                   { Id: 5, RequestName: "For Leave" },
                                                   { Id: 6, RequestName: "For Release Letter" },
                                                   { Id: 7, RequestName: "For 5+ Years Early Leave Privilege" }
                             ];
                             var NOCTypeList = [{ Id: 1, NOCName: "Travelling NOC" },
                                              { Id: 2, NOCName: "Not Travelling NOC" }
                             ]
                             $scope.RequestListType = RequesType;
                             $scope.NOCType = NOCTypeList;
                             GetAllRequestList();
                             getAllDropdowns();
                            // GetAllLeaveType();
                             GetAllLeaveCategory();
                             //getEmpMeetingList();
                             $scope.imgfile = true;
                             $scope.modalTitle = 'Add';

                         };
                         $scope.reset = function reset() {
                             $scope.Request = {};
                             $scope.Request.Id = 0;
                             $scope.modalTitle = 'Add ';
                             $scope.btnTitle = 'Save';

                             $scope.Leave = {};
                             $("#custom_text").html("No file chosen, yet.");
                             $(".demoInputBox").css("color", "#aaa");
                         }

                       function resetform() {
                             $scope.Request = {};
                             $scope.Request.Id = 0;
                             $scope.modalTitle = 'Add ';
                             $scope.btnTitle = 'Save';

                             $scope.Leave = {};
                             $("#custom_text").html("No file chosen, yet.");
                             $(".demoInputBox").css("color", "#aaa");
                         }

                         $scope.SaveRequest = function SaveRequest(n) {
                             if ($scope.formCommonFeilds.RequestType.$invalid == true)
                                 return;

                             if (n.RequestType == 1) {
                                 if ($scope.Request.CategoryId == null) {
                                     toastr["warning"]("Category Field is Required.");
                                     return;
                                 }
                                 if (

                                      $scope.formCommonFeilds.Reason.$invalid == true
                                     || $scope.formCommonFeilds.date.$invalid == true
                                     || $scope.formCommonFeilds.Time.$invalid == true
                                     )
                                     return;
                             } else if (n.RequestType == 2) {
                                 if ($scope.formCommonFeilds.date.$invalid == true)
                                     return;


                             }
                             else if (n.RequestType == 7) {
                                 if ($scope.formCommonFeilds.date.$invalid == true
                                     || $scope.formCommonFeilds.Description.$invalid == true)
                                     return;


                             }
                             else if (n.RequestType == 3) {
                                 if ($scope.formCommonFeilds.NOCType.$viewValue == 1) {
                                     if ($scope.formCommonFeilds.TravelFrom.$invalid == true
                                    || $scope.formCommonFeilds.TravelTo.$invalid == true
                                    || $scope.formCommonFeilds.Description.$invalid == true) {

                                         return;
                                     }

                                 } else {
                                     if ($scope.formCommonFeilds.Description.$invalid == true) {
                                         return;
                                     }
                                 }
                                 if ($scope.Request.TravelFrom > $scope.Request.TravelTo) {
                                     toastr["warning"]("Invalid Date.");
                                     $('#exampleModal').show();
                                     return;
                                 }

                             } else if (n.RequestType == 4) {
                                 if ($scope.formCommonFeilds.Reason.$invalid == true
                                    || $scope.formCommonFeilds.Description.$invalid == true
                                    )
                                     return;

                             } else if (n.RequestType == 5) {
                                 var files = $("#real_file").get(0).files;

                                 if (files.length == 0) {
                                     if ($scope.formCommonFeilds.LeaveCategoryId.$invalid == true
                                   || $scope.formCommonFeilds.FromDate.$invalid == true
                                   || $scope.formCommonFeilds.To.$invalid == true
                                   || $scope.formCommonFeilds.Description.$invalid == true
                                   )
                                         return;
                                 }

                                 else {

                                     var files = $("#real_file").get(0).files;
                                     //console.log(files);
                                     var file_size = $('#real_file')[0].files[0].size;
                                     if (file_size > 2097152) {
                                         toastr["warning"]("File Size Only 2MB.");
                                         return;
                                         if ($scope.formCommonFeilds.LeaveCategoryId.$invalid == true
                               || $scope.formCommonFeilds.FromDate.$invalid == true
                               || $scope.formCommonFeilds.To.$invalid == true
                               || $scope.formCommonFeilds.Request.$invalid == true
                               || $scope.formCommonFeilds.Description.$invalid == true
                               )
                                             return;
                                     }
                                 }

                             }
                             if ($scope.Request.RequestType != 0) {
                                 var files = $("#real_file").get(0).files;
                                 if ($scope.Request.Id == 0) {     ///Add Request
                                     $http({
                                         method: 'POST',
                                         url: baseUrl + 'Employee/AddRequest/',
                                         headers: { 'Content-Type': undefined },
                                         transformRequest: function (data) {
                                             var formData = new FormData();
                                             formData.append('Request', JSON.stringify($scope.Request));
                                             if (files.length > 0)
                                                 formData.append("file", files[0]);
                                             return formData;
                                         },
                                         data: $scope.Request
                                     }).then(function SuccessCallback(response) {
                                         if (response.data == 0) {
                                             toastr["success"]("you Holiday Select.");
                                         } else if (response.data == 2) {
                                             toastr["error"]("Academic Clander Doesn't SetUp.");
                                         } else if (response.data.results == 3) {
                                             toastr["success"](response.data.message);
                                             $('#exampleModal').show();

                                         } else {
                                             toastr["success"](response.data.message);
                                             $('#exampleModal').hide();
                                      $('.modal-backdrop').remove();
                                             resetform();
                                             blockUI.start();
                                             GetAllRequestList();
                                             blockUI.stop();
                                         }
                                     });
                                 } else {            //Updated Request
                                     $http({
                                         method: 'POST',
                                         url: baseUrl + 'Employee/UpdateRequest/',
                                         headers: { 'Content-Type': undefined },
                                         transformRequest: function (data) {
                                             var formData = new FormData();
                                             formData.append('Request', JSON.stringify($scope.Request));
                                             if (files.length > 0)
                                                 formData.append("file", files[0]);
                                             return formData;
                                         },
                                         data: $scope.Request
                                     }).then(function SuccessCallback(response) {
                                         if (response.data == 0) {
                                             toastr["success"]("you Holiday Select.");
                                         } else if (response.data == 2) {
                                             toastr["error"]("Academic Clander Doesn't SetUp.");
                                         } else if (response.data.results == 3) {
                                             toastr["success"](response.data.message);
                                             $('#exampleModal').show();

                                         } else {
                                             toastr["success"](response.data.message);
                                             $('#exampleModal').hide();
                                             $('.modal-backdrop').remove();
                                             blockUI.start();
                                             GetAllRequestList();
                                             resetform();
                                             blockUI.stop();
                                         }
                                     });
                                 }
                             }


                         }
                         $scope.view = function (n) {
                             //console.log(n);
                             $scope.Request = n;
                             $scope.Request.Id = n.Id;
                             $scope.Request.RequestType = n.ReqID;
                             $scope.Request.NOCType = n.NOCType;
                             Request.Description = n.Description;
                             $scope.Request.date = new Date(n.Date);
                             if ($scope.Request.RequestType == 1) {
                                 $scope.Request.CategoryId = n.CategoryId.toString();
                                 Request.Text = n.Text;
                                 $scope.Request.Time = new Date(n.Time);
                             }
                             if ($scope.Request.NOCType == 1) {

                                 $scope.Request.TravelDesination = n.TravelDesination;
                                 $scope.Request.TravelFrom = new Date(n.TravelFrom);
                                 $scope.Request.TravelTo = new Date(n.TravelTo);

                             }
                             if ($scope.Request.RequestType == 4) {
                                 $scope.Request.LeaveDate = new Date(n.LeaveDate);

                             }
                             if ($scope.Request.RequestType == 5) {
                                 $scope.Request.LeaveCategoryId = n.LeaveCategoryId;
                                 //$scope.Request.Request = new Date(n.RequestOn);
                                 $scope.Request.From = new Date(n.FromDate);
                                 $scope.Request.To = new Date(n.ToDate);

                             }

                         }
                         $scope.edit = function (n) {
                             $scope.modalTitle = 'Update ';
                             $scope.btnTitle = 'Update';
                             //console.log(n);
                             $scope.Request = n;
                             $scope.Request.Id = n.Id;
                             $scope.Request.RequestType = n.ReqID;
                             $scope.Request.NOCType = n.NOCType;
                             $scope.Request.date = new Date(n.Date);
                             if ($scope.Request.RequestType == 1) {
                                 $scope.Request.CategoryId = n.CategoryId.toString();
                                 $scope.Request.Time = new Date(n.Time);
                             }
                             if ($scope.Request.NOCType == 1) {

                                 $scope.Request.TravelDesination = n.TravelDesination;
                                 $scope.Request.TravelFrom = new Date(n.TravelFrom);
                                 $scope.Request.TravelTo = new Date(n.TravelTo);

                             }
                             if ($scope.Request.RequestType == 4) {
                                 $scope.Request.LeaveDate = new Date(n.LeaveDate);

                             }
                             if ($scope.Request.RequestType == 5) {
                                 $scope.Request.LeaveCategoryId = n.LeaveCategoryId;
                                 $scope.Request.Request = new Date(n.AddDate);
                                 $scope.Request.From = new Date(n.FromDate);
                                 $scope.Request.To = new Date(n.ToDate);

                             }

                         }

                         function getEmpMeetingList() {
                             $scope.EmpMeetingList = [];
                             blockUI.start();
                             $http({
                                 method: 'GET',
                                 url: baseUrl + 'PortalRequest/GetMeetingList/'
                             }).then(function SuccessCallback(response) {
                                 $scope.EmpMeetingList = response.data.results;
                                 blockUI.stop();
                             });
                         }

                         $scope.DeleteRequest = function DeleteRequest(Id) {

                             SweetAlert.swal({
                                 title: "Are you sure to delete it ?", type: "warning", showCancelButton: true, confirmButtonColor: "#DD6B55",
                                 confirmButtonText: "Yes, delete it!",
                                 closeOnConfirm: false
                             },
                         function (isConfirm) {
                             if (isConfirm) {

                                 $http({
                                     method: 'POST',
                                     url: baseUrl + 'Employee/DeleteRequest/' + Id
                                 }).then(function successCallback(response) {
                                     SweetAlert.swal("Deleted!", "Your data has been deleted.", "success");
                                     GetAllRequestList();
                                     toastr["success"](response.data.message);
                                 }, function errorCallback(response) {
                                     GetAllRequestList();
                                     toastr["error"](response.data.message);
                                 });

                             }
                         });
                         }
                         $scope.CalculateDuratoin = function CalculateDuratoin() {
                             var From = new Date($scope.Request.From);
                             var To = new Date($scope.Request.To);
                             if (To < From) {
                                 toastr["info"]("Please Select a Valid Date Range.");
                                 $scope.Request.To = null;
                                 $scope.Request.Duration = null;
                             } else {
                                 $scope.Request.Duration = (((((To - From) / 1000) / 60) / 60) / 24) + 1;
                             }
                             //var Durat = To-From
                             //alert(From);
                             //alert(To);
                             //alert(duration)
                         }
                         function validate() {
                             $("#file_error").html("");
                             $(".demoInputBox").css("color", "#dc3545");
                             var file_size = $('#real_file')[0].files[0].size;
                             if (file_size > 2097152) {
                                 $("#custom_text").html("(Maximum 2MB)");
                                 //console.log("File size is greater than 2MB");
                                 //$("#file_error").html("File size is greater than 2MB");
                                 $(".demoInputBox").css("border-color", "#FF0000");
                                 return false;
                             }
                             return true;
                         }
                         function GetAllRequestList() {
                             blockUI.start();
                             $http({
                                 method: 'GET',
                                 url: baseUrl + 'Employee/GetAllRequestList/'
                             }).then(function SuccessCallback(response) {
                                 $scope.RequestList = response.data.results;
                                 console.log($scope.RequestList);
                                 blockUI.stop();
                             })
                         }

                         $scope.LoadCategory = function LoadCategory() {

                             $http({
                                 method: 'GET',
                                 url: baseUrl + 'Employee/GetAllCategory/'
                             }).then(
                             function SuccessCallback(response) {
                                 $scope.CategoryList = response.data.results;
                                 //console.log(DepartmentList);

                             }
                             )
                         }
                         $scope.LoadDesignation = function LoadDesignation(Id) {

                             $http({
                                 method: 'GET',
                                 url: baseUrl + 'PortalRequest/GetAllDesignation/' + Id
                             }).then(
                             function SuccessCallback(response) {
                                 $scope.DesignationList = response.data.results;
                                 //console.log(DesignationList);
                             }
                             )
                         }



                         function getAllDropdowns() {
                             $scope.Dropdowns = [];

                             $http({
                                 method: 'GET',
                                 url: baseUrl + 'Common/GetAllDropDown/'
                             }).then(function successCallback(response) {
                                 //console.log(response.data.results);
                                 $scope.Dropdowns = response.data.results;
                             }, function errorCallback(response) {
                             });

                         }
                         //function GetAllLeaveType() {
                         //    $http({
                         //        method: 'GET',
                         //        url: baseUrl + 'Attendance/GetAllLeaveType'
                         //    }).then(function successCallback(response) {
                         //        $scope.LeaveType = response.data.results;

                         //    }, function errorCallback(response) {
                         //        toastr["warning"](response.data.message);
                         //    });
                         //};

                         function GetAllLeaveCategory() {
                             $http({
                                 method: 'GET',
                                 url: baseUrl + 'Employee/GetAllLeaveCategory/'
                             }).then(function successCallback(response) {
                                 $scope.LeaveCategory = response.data.results;

                             }, function errorCallback(response) {
                                 toastr["warning"](response.data.message);
                             });
                         };

                     }]);
    </script>
}

