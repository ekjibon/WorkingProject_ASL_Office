
@{
    ViewBag.Title = "Employee ID Card";
}
@section Styles{
    <link href="~/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.css" rel="stylesheet" type="text/css" />
}

<div class="kt-container  kt-container--fluid  kt-grid__item kt-grid__item--fluid" ng-controller="employeeList">
    <div class="row">
        <div class="kt-portlet kt-portlet--mobile">
            <div class="kt-portlet__head kt-portlet__head--lg">
                <div class="kt-portlet__head-label">
                    <h3 class="kt-portlet__head-title">
                        <!----Titel Text-->
                        Employee ID Card
                        <!----Titel Text -->
                    </h3>
                </div>
            </div>

            <div class="kt-portlet__body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group row" ng-class="{ 'has-error' : submitted1 && formCommonFeilds.Branch.$invalid}">
                            <label class="col-md-4 control-label text-right">
                                Branch
                            </label>
                            <div class="col-md-8">
                                <select class="form-control" ng-model="employeeInfo.BranchID" name="Branch" ng-options="employeeInfo.BranchId as employeeInfo.BranchName for employeeInfo in CommonFeilds.Branch">
                                    <option value="" selected="selected">Select</option>
                                </select>
                                <div class="form-control-focus"> </div>
                                <span ng-show="submitted1 && formCommonFeilds.Branch.$error.required" class="help-block">Branch Name Required</span>

                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-4 control-label text-right">
                                Version
                            </label>
                            <div class="col-md-8">

                                <select class="form-control" ng-model="employeeInfo.VersionID" name="Version" ng-options="employeeInfo.VersionId as employeeInfo.VersionName for employeeInfo in CommonFeilds.Version">
                                    <option value="" selected="selected">Select</option>
                                </select>

                                <div class="form-control-focus"> </div>

                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-4 control-label text-right">
                                DOB From
                            </label>
                            <div class="col-md-8">
                                <input class="form-control" type="text" ng-click="p1=true" is-open="p1" readonly ng-model="employeeInfo.DateOfBirth" name="DateOfBirth" placeholder="DOB From" uib-datepicker-popup="dd/MM/yyyy" />
                                <div class="form-control-focus"> </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="form-group row">
                            <label class="col-md-4 control-label text-right">
                                Category
                            </label>
                            <div class="col-md-8">
                                <select class="form-control" ng-model="employeeInfo.CategoryID" name="Class" ng-change="" ng-options="employeeInfo.CategoryID as employeeInfo.CategoryName for employeeInfo in CommonFeilds.Category">
                                    <option value="" selected="selected">Select</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-4 col-sm-offset-0 control-label text-right">
                                Designation

                            </label>
                            <div class="col-sm-8">
                                <select class="form-control" ng-model="employeeInfo.DesignationID" name="Designation" ng-options="employeeInfo.DesignationID as employeeInfo.DesignationName for employeeInfo in CommonFeilds.Designation">
                                    <option value="" selected="selected">Select</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-4 control-label text-right">
                                DOB To
                            </label>
                            <div class="col-md-8">
                                <input class="form-control" type="text" ng-click="p2=true" is-open="p2" readonly ng-model="employeeInfo.ConfirmationDate" name="ConfirmationDate" placeholder="DOB To" uib-datepicker-popup="dd/MM/yyyy" />
                                <div class="form-control-focus"> </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group row">
                            <label class="col-sm-4 control-label pull-left text-right">
                                Emp.
                            </label>
                            <div class="col-md-8">
                                @*<input type="text" ng-model="employeeInfo.EmpID" class="form-control" placeholder="EmpID" name="EmpID">*@
                                <input type="text" name="StudentId" ng-model="Std" typeahead-on-select='onSelect($item, $model, $label)'
                                       placeholder="Search name/ID"
                                       uib-typeahead="i  as i.Text for i in Search($viewValue)"
                                       typeahead-loading="loadingLocations" typeahead-no-results="noResults" class="form-control">
                                <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>
                                <div ng-show="noResults"><i class="glyphicon glyphicon-remove"></i> No Results Found</div>
                                <input type="hidden" name="StudentIID" ng-value="Std.Value" />
                                <div class="form-control-focus"> </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-4 control-label text-right">
                                Status
                            </label>
                            <div class="col-md-8">
                                <select class="form-control" ng-model="employeeInfo.Status" name="Status">
                                    <option value="" selected="selected">Select</option>
                                    <option value="A">Active</option>
                                    <option value="I">Inactive</option>
                                </select>
                                <div class="form-control-focus"> </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-4 control-label text-right">
                                Joining
                            </label>
                            <div class="col-md-8">
                                <input class="form-control" type="text" ng-click="p3=true" is-open="p3" readonly ng-model="employeeInfo.JoiningDate" name="JoiningDate" placeholder="Joining Date" uib-datepicker-popup="dd/MM/yyyy" />
                                <div class="form-control-focus"> </div>
                            </div>
                        </div>

                        <div class="form-group row">
                            <div class="col-md-12 pull-right">
                                <button type="submit" ng-click="GetEmployeeList()" class="btn btn-primary pull-right">Show</button>
                            </div>
                        </div>


                    </div>
                </div>
                <table class="table table-bordered table-hover rounded">
                    <thead>
                        <tr class="btn-primary">
                            @*<td>  <input type="checkbox" ng-model="selectedAll" ng-click="selectAll()" /></td>*@
                            <th><input type="checkbox" ng-model="selectedAll" ng-click="selectAll()" />  All</th>
                            <th>  Employee ID</th>
                            <th>  Name</th>
                            <th>  Designation </th>
                            <th>  Joining Date </th>
                            <th> SMS Notification Number </th>
                            <th> Status </th>
                            <th>  Options </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="item in employeeInfos" >
                            <td> <input type="checkbox" ng-model="item.Selected" value="false" ng-click="checkIfAllSelected()" /> </td>
                            <td>{{item.EmpID}} </td>
                            <td>{{item.FullName}} </td>
                            <td>{{item.DesignationName}} </td>
                            <td>{{item.JoiningDate | date}} </td>
                            <td>{{item.SMSNotificationNo}} </td>
                            <td ng-show="item.Status=='A'" style="color:blue">Active</td>
                            <td ng-hide="item.Status=='A'" style="color:red">Inactive</td>
                            <td>
                                <div class="btn-group">
                                    <button ng-click="EmployeeIdCard(item.EmpID)" class="btn btn-success btn-xs green dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
                                        ID Card
                                        <i class="fa fa-download"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div>
                    <div class="form-group row" ng-show="tblshow">
                        <div class="col-md-12 pull-right">
                            <button ng-click="EmployeeIdCardAll()" class="btn btn-success pull-right">Selected Id Card<i class="fa fa-download"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--Modal Area Start-->
<div id="EditEmployeeForm" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <form name="addform" class="form-horizontal" id="form_sample_1" novalidate>
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    <h4 class="modal-title">{{modalTitle}}</h4>
                </div>
                <div class="modal-body">
                    <div class="form-body">

                        <div class="row">

                            @*Emp Name and others*@

                            <div class="row" style="padding:5px;">
                                <div class="col-md-6">

                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Name.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Employee Name :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfo2.FullName" class="form-control" placeholder="Employee Name" name="FullName" required>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted &&  addBasic.Name.$error.required" class="help-block">Full Name Required</span>
                                        </div>
                                    </div>
                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.NameBangla.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Father's Name :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfo2.FatherName" class="form-control" placeholder="Father Name Name" name="FatherName" required>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted &&  addBasic.FatherName.$error.required" class="help-block">Father Name Required</span>
                                        </div>
                                    </div>
                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.NameBangla.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Mother's Name :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfo2.MotherName" class="form-control" placeholder="Mother Name Name" name="MotherName" required>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted &&  addBasic.MotherName.$error.required" class="help-block">Mother Name Required</span>
                                        </div>
                                    </div>


                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Religion.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            SMS Notification Number:
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfo2.SMSNotificationNo" class="form-control" placeholder="SMS Notification Number" name="SMSNumber" required>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted &&  addBasic.Name.$error.required" class="help-block">Full Name Required</span>
                                        </div>
                                    </div>


                                </div>

                                <div class="col-md-6">
                                    <div class="fileinput fileinput-new" data-provides="fileinput">
                                        <div class="row">

                                            <div class="col-md-12 pull-right">
                                                <div class="fileinput-preview thumbnail" data-trigger="fileinput" style="width: 80px; height: 82px;">
                                                    <img src="@String.Format("data:image/jpg;base64,{0}", "{{employeeInfo2.Image}}")" alt="...">
                                                </div>

                                            </div>

                                            @*<div style="float:left !important" class="col-md-4">
                                                    <span class="btn red btn-outline btn-file">
                                                        <span class="fileinput-new"> Select image </span>
                                                        <span class="fileinput-exists"> Change </span>
                                                        <img ng-src="data:image/png;base64,{{img}}">
                                                        <input type="file" id="imgs">

                                                    </span>
                                                    <a href="javascript:;" style="margin-top:10px !important" class="btn red fileinput-exists" data-dismiss="fileinput"> Remove </a>
                                                </div>*@
                                        </div>
                                    </div>


                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Gender.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Gender :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <select class="form-control" ng-model="employeeInfo2.Gender" required name="Gender" ng-options="employeeInfo2.Value as employeeInfo2.Text for employeeInfo2 in Dropdowns | filter:Type='Gender'">
                                                <option value="" selected="selected">Choose Option</option>
                                            </select>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted && addBasic.Gender.$error.required" class="help-block">Gender Required</span>
                                        </div>
                                    </div>

                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Religion.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Religion :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <select class="form-control" ng-model="employeeInfo2.Religion" required name="Religion" ng-options="employeeInfo2.Value as employeeInfo2.Text for employeeInfo2 in Dropdowns | filter:Type='Religion'">
                                                <option value="" selected="selected">Choose Option</option>
                                            </select>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted && addBasic.Religion.$error.required" class="help-block">Religion Required</span>
                                        </div>
                                    </div>


                                </div>
                            </div>


                            <div class="row" style="padding:5px;">
                                <div class="col-md-6">
                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Blood.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Blood Group :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <select class="form-control" ng-model="employeeInfo2.BloodGroup" required name="Blood" ng-options="employeeInfo2.Value as employeeInfo2.Text for employeeInfo2 in Dropdowns | filter:Type='Blood Group'">
                                                <option value="" selected="selected">Choose Option</option>
                                            </select>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted && addBasic.Blood.$error.required" class="help-block">Blood Group Required</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-4 control-label text-right">
                                            Nationality:
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfo2.Nationality" class="form-control" placeholder="Nationality" name="Nationality">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row" style="padding:5px;">
                                <div class="col-md-6">
                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.DOB.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Date of Birth:
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" disabled="disabled" ng-model="employeeInfo2.DateOfBirth" size="8" />
                                            <input class="form-control" type="text" ng-change="getOrderbydate()" ng-click="p2=true" is-open="p2" uib-datepicker-popup="dd-MM-yyyy" ng-model="employeeInfo2.DateOfBirth" readonly placeholder="Change Date of Birth" name="DateOfBirth" />
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted && addBasic.DOB.$error.required" class="help-block">Date of Birth Required</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-4 control-label text-right">
                                            National ID:
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfo2.NationalID" class="form-control" placeholder="National ID" name="NationalID">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row" style="padding:5px;">
                                <div class="col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-4 control-label text-right" style="padding-left: 1px;">
                                            Marital Status
                                        </label>
                                        <div class="col-md-8">
                                            <select class="form-control" ng-model="employeeInfo2.MaritalStatus">
                                                <option value="" selected="selected">Choose Option</option>
                                                <option value="Single">Single</option>
                                                <option value="Married">Married</option>
                                                <option value="Divorced">Divorced</option>
                                                <option value="Widowed">Widowed</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-4 control-label text-right">
                                            Passport NO:
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfo2.PassportNo" name="PassportNo" class="form-control" placeholder="Passport No">
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" data-dismiss="modal" class="btn  btn-secondary" submitted=false">Cancel</button>
                    <button type="submit" data-dismiss="modal" ng-click="UpdateEmployee(employeeInfo2)" class="btn btn-primary" ng-disabled="btnDis">Save <i ng-show="spin" class="fa fa-spinner fa-spin" style="font-size:20px"></i></button>
                </div>
            </form>
        </div>
    </div>
</div>
<div id="ViewEmployee" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <form name="addform" class="form-horizontal" id="form_sample_1" novalidate>
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    <h4 class="modal-title">{{modalTitle}}</h4>
                </div>
                <div class="modal-body">
                    <div class="form-body">

                        <div class="row">

                            @*Emp Name and others*@

                            <div class="row" style="padding:5px;">
                                <div class="col-md-6">

                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Name.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Employee Name :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfoView.FullName" class="form-control" placeholder="Employee Name" name="FullName" required>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted &&  addBasic.Name.$error.required" class="help-block">Full Name Required</span>
                                        </div>
                                    </div>
                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.NameBangla.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Father's Name :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfoView.FatherName" class="form-control" placeholder="Father Name Name" name="FatherName" required>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted &&  addBasic.FatherName.$error.required" class="help-block">Father Name Required</span>
                                        </div>
                                    </div>
                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.NameBangla.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Mother's Name :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfoView.MotherName" class="form-control" placeholder="Mother Name Name" name="MotherName" required>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted &&  addBasic.MotherName.$error.required" class="help-block">Mother Name Required</span>
                                        </div>
                                    </div>


                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Religion.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            SMS Notification Number:
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfoView.SMSNotificationNo" class="form-control" placeholder="SMS Notification Number" name="SMSNumber" required>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted &&  addBasic.Name.$error.required" class="help-block">Full Name Required</span>
                                        </div>
                                    </div>


                                </div>

                                <div class="col-md-6">
                                    <div class="fileinput fileinput-new" data-provides="fileinput">
                                        <div class="row">

                                            <div class="col-md-12 pull-right">
                                                <div class="fileinput-preview thumbnail" data-trigger="fileinput" style="width: 80px; height: 82px;">
                                                    <img src="@String.Format("data:image/jpg;base64,{0}", "{{employeeInfoView.Image}}")" alt="...">
                                                </div>

                                            </div>

                                            @*<div style="float:left !important" class="col-md-4">
                                                    <span class="btn red btn-outline btn-file">
                                                        <span class="fileinput-new"> Select image </span>
                                                        <span class="fileinput-exists"> Change </span>
                                                        <img ng-src="data:image/png;base64,{{img}}">
                                                        <input type="file" id="imgs">

                                                    </span>
                                                    <a href="javascript:;" style="margin-top:10px !important" class="btn red fileinput-exists" data-dismiss="fileinput"> Remove </a>
                                                </div>*@
                                        </div>
                                    </div>


                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Gender.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Gender :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <select class="form-control" ng-model="employeeInfoView.Gender" required name="Gender" ng-options="employeeInfoView.Value as employeeInfoView.Text for employeeInfoView in Dropdowns | filter:Type='Gender'">
                                                <option value="" selected="selected">Choose Option</option>
                                            </select>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted && addBasic.Gender.$error.required" class="help-block">Gender Required</span>
                                        </div>
                                    </div>

                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Religion.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Religion :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <select class="form-control" ng-model="employeeInfoView.Religion" required name="Religion" ng-options="employeeInfoView.Value as employeeInfoView.Text for employeeInfoView in Dropdowns | filter:Type='Religion'">
                                                <option value="" selected="selected">Choose Option</option>
                                            </select>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted && addBasic.Religion.$error.required" class="help-block">Religion Required</span>
                                        </div>
                                    </div>


                                </div>
                            </div>


                            <div class="row" style="padding:5px;">
                                <div class="col-md-6">
                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.Blood.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Blood Group :
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <select class="form-control" ng-model="employeeInfoView.BloodGroup" required name="Blood" ng-options="employeeInfoView.Value as employeeInfoView.Text for employeeInfoView in Dropdowns | filter:Type='Blood Group'">
                                                <option value="" selected="selected">Choose Option</option>
                                            </select>
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted && addBasic.Blood.$error.required" class="help-block">Blood Group Required</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-4 control-label text-right">
                                            Nationality:
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfoView.Nationality" class="form-control" placeholder="Nationality" name="Nationality">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row" style="padding:5px;">

                                <div class="col-md-6">
                                    <div class="form-group row" ng-class="{ 'has-error' : submitted && addBasic.DOB.$invalid}">
                                        <label class="col-md-4 control-label text-right">
                                            Date of Birth:
                                            <span class="required">*</span>
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" disabled="disabled" ng-model="employeeInfoView.DateOfBirth" size="8" />
                                            <input class="form-control" type="text" ng-change="getOrderbydate()" ng-click="p2=true" is-open="p2" uib-datepicker-popup="dd-MM-yyyy" ng-model="employeeInfoView.DateOfBirth" readonly placeholder="Change Date of Birth" name="DateOfBirth" />
                                            <div class="form-control-focus"> </div>
                                            <span ng-show="submitted && addBasic.DOB.$error.required" class="help-block">Date of Birth Required</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-4 control-label text-right">
                                            National ID:
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfoView.NationalID" class="form-control" placeholder="National ID" name="NationalID">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row" style="padding:5px;">
                                <div class="col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-4 control-label text-right" style="padding-left: 1px;">
                                            Marital Status
                                        </label>
                                        <div class="col-md-8">
                                            <select class="form-control" ng-model="employeeInfoView.MaritalStatus">
                                                <option value="" selected="selected">Choose Option</option>
                                                <option value="Single">Single</option>
                                                <option value="Married">Married</option>
                                                <option value="Divorced">Divorced</option>
                                                <option value="Widowed">Widowed</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-4 control-label text-right">
                                            Passport NO:
                                        </label>
                                        <div class="col-md-8">
                                            <input type="text" ng-model="employeeInfoView.PassportNo" name="PassportNo" class="form-control" placeholder="Passport No">
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" data-dismiss="modal" class="btn dark btn-outline" submitted=false">Cancel</button>
                    <button type="submit" data-dismiss="modal" ng-click="EditFormEmployee(employeeInfoView.EmpBasicInfoID)" class="btn btn-primary" ng-disabled="btnDis">Save <i ng-show="spin" class="fa fa-spinner fa-spin" style="font-size:20px"></i></button>
                </div>
            </form>
        </div>
    </div>
</div>
<!--Modal Area End-->

@section Scripts{


    <script src="~/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js" type="text/javascript"></script>
    <script type="text/javascript">

        OEMSApp.controller("employeeList", ["$scope", "$http", "SweetAlert",
              function ($scope, $http, SweetAlert) {

                  init();
                  function init() {
                      initialize();

                      getAllDropdowns();
                      getAllCommons();


                  }
                  function initialize() {
                      $scope.tblshow = false;
                      $scope.modalTitle = "Edit Employee Info";
                      $scope.GetEmployeeList = GetEmployeeList;
                      $scope.employeeInfo = {};
                      $scope.employeeInfoView = {};

                      $scope.EmpID = '';
                      $scope.EmpBasicInfoID = '';
                      $scope.employeeInfos = [];
                      $scope.CommonFeilds = [];

                      $scope.employeeInfoListShow = {};
                      $scope.employeeInfo2 = {};

                      $scope.getAllCommons = getAllCommons;
                      $scope.getAllDropdowns = getAllDropdowns;
                      //Edit
                      $scope.EditFormEmployee = EditFormEmployee;
                      $scope.UpdateEmployee = UpdateEmployee;

                      //view


                      $scope.currentPage = 1;
                      $scope.pageno = 1;
                      $scope.pagesize = 10;
                      $scope.total_count = 12;
                      $scope.search = '';
                      $scope.resetForm = resetForm;

                      $scope.Dropdowns = [];
                      $scope.CommonFeilds = [];
                      $scope.getAllDropdowns = getAllDropdowns;

                  }

                  function resetForm() {

                      $scope.employeeInfo.EmpID = '';
                      $scope.submitted = false;
                      $scope.Id = '';

                  }

                  $scope.EmployeeIdCard = function(EmpId)
                  {
                      var win = window.open('/Report/EmployeeIdCard?EmpIds=' + EmpId, '_blank');
                      win.focus();
                  }
                  $scope.EmployeeIdCardAll = function () {
                      var EmpIds = $scope.GetSelects();
                      if (EmpIds.length < 3)
                      {
                          alert('Please select employee first.');
                          return;
                      }

                      var win = window.open('/Report/EmployeeIdCard?EmpIds=' + EmpIds, '_blank');
                      win.focus();

                      //alert(EmpIds);
                  }
                  $scope.Search = function (val) {
                      return $http.get(baseUrl + 'Employee/SearchEmployee/' + val, {
                          params: {

                          }
                      }).then(function (response) {
                          return response.data.results.map(function (item) {
                              return item;
                          });
                      });
                  };

                  $scope.onSelect = function onSelect($item, $model, $label) {
                      $scope.StudentIID = $item.Value;
                      SearchEmployeeId($item.Value);
                  };

                  function SearchEmployeeId(EmpID) {
                      $scope.employeeInfos = [];
                      $http({
                          method: 'GET',
                          url: baseUrl + 'Employee/GetEmployeeID/' + EmpID
                      }).then(function successCallback(response) {
                          $scope.employeeInfos = response.data.results;
                      }, function errorCallback(response) {
                          toastr["error"](response.data.Message);
                      });
                  }

                  $scope.lockuser = function lockuser(Ob) {
                      console.log(Ob);
                      var x = $scope.employeeInfos.indexOf(Ob);
                      var statustxt;
                      console.log(x);
                      if (Ob.Status == 'A')
                      {
                          statustxt = 'In-Active';
                          Ob.Status = 'D';
                      }
                      else
                      {
                          statustxt = 'Active';
                          Ob.Status = 'A';
                      }
                      SweetAlert.swal({
                          title: "Are you sure to " + statustxt + " this employee    (" + Ob.FullName + ")?", type: "warning", showCancelButton: true, confirmButtonColor: "#DD6B55",
                          confirmButtonText: "Yes",
                          closeOnConfirm: false
                      },
                      function (isConfirm) {
                          if (isConfirm) {
                              $http({
                                  method: 'PUT',
                                  url: baseUrl + 'Employee/UpdateStatus/' + Ob.EmpID + '/' + Ob.Status
                              }).then(function successCallback(response) {
                                  SweetAlert.swal(statustxt + "!", "This user is  " + Ob.FullName + ", Action success");

                              }, function errorCallback(response) {

                              });

                          }
                      });
                  };

                  function GetEmployeeList() {
                      $scope.employeeInfos = [];
                      $http({
                          method: 'POST',
                          url: baseUrl + 'Employee/GetEmployeeInfo/',
                          data: $scope.employeeInfo
                      }).then(function successCallback(response) {
                          $scope.employeeInfos = response.data.results;
                          $scope.tblshow = true;
                          toastr["info"](response.data.message);

                      }, function errorCallback(response) {
                          toastr["error"](response.data.message);
                      });

                  }

                  //Edit
                  function EditFormEmployee(n) {
                      $scope.EmpBasicInfoID = n;
                      // $scope.employeeInfo = {};
                      $http({
                          method: 'GET',
                          url: baseUrl + 'Employee/GetSingleEmployeeInfo/' + $scope.EmpBasicInfoID
                      }).then(function successfullCallback(respons) {
                          $scope.employeeInfo2 = respons.data.results;
                          $("#EditEmployeeForm").modal('toggle');
                      },
                      function errorCallback(respons) {
                          toastr["info"](respons.data.message);

                      });

                  }

                  function UpdateEmployee(n) {
                      $scope.employeeInfo2 = n;
                      $http({
                          method: 'PUT',
                          url: baseUrl + 'Employee/UpdateEmployee',
                          data: $scope.employeeInfo2
                      }).then(function successfullCallback(respons) {

                          GetEmployeeList();
                          toastr["info"](respons.data.message);

                      })
                  }

                  $scope.selectAll = function () {
                      angular.forEach($scope.employeeInfos, function (item) {
                          item.Selected = $scope.selectedAll;
                      });

                  };

                  $scope.GetSelects = function GetSelects() {
                      var res = '';
                      angular.forEach($scope.employeeInfos, function (item) {
                          if (item.Selected) {
                              res = res + ',' + item.EmpID
                          }
                      });
                      console.log(res);
                      return res.trim()
                  };

                  $scope.CreateNewUsers = function CreateNewUsers() {
                      var Ids = [];
                      angular.forEach($scope.employeeInfos, function (item) {
                          if (item.Selected) {
                              Ids.push(item.EmpBasicInfoID);
                          }
                      });
                      if (Ids.length == 0) {
                          toastr["warning"]("No Teacher Selected");
                          return;
                      }

                      $http({
                          method: 'POST',
                          url: baseUrl + 'users/BulkEmpUserCreate/',
                          data: Ids
                      }).then(function successCallback(response) {

                          toastr["success"](response.data.message);

                      }, function errorCallback(response) {
                          toastr["error"](response.data.message);
                      });
                  };

                  function getAllCommons() {
                      $scope.CommonFeilds = [];

                      $http({
                          method: 'GET',
                          url: baseUrl + 'Common/GetCommonItemEmp/'
                      }).then(function successCallback(response) {
                          $scope.CommonFeilds = response.data.results;
                      }, function errorCallback(response) {
                      });
                  }

                  function getAllDropdowns() {
                      $scope.Dropdowns = [];
                      $http({
                          method: 'GET',
                          url: baseUrl + 'Common/GetAllDropDown/'
                      }).then(function successCallback(response) {
                          $scope.Dropdowns = response.data.results;
                      }, function errorCallback(response) {
                      });
                  }

                  function getAllCommons() {
                      $scope.CommonFeilds = [];

                      $http({
                          method: 'GET',
                          url: baseUrl + 'Common/GetCommonItemEmp/'
                      }).then(function successCallback(response) {
                          $scope.CommonFeilds = response.data.results;
                      }, function errorCallback(response) {
                      });
                  }

              }]);
    </script>
}